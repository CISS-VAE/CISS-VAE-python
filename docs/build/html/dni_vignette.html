

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Avoiding imputation undesired data entries &mdash; CISS-VAE 1.0.18 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/styles.css" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=14ed45bf"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=00122899"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Reference" href="api.html" />
    <link rel="prev" title="Using create_missingness_prop_matrix: A Complete Guide" href="missingness_prop_vignette.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            CISS-VAE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">CISS-VAE Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html#quickstart">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="vignette.html">How to use CISS-VAE</a></li>
<li class="toctree-l1"><a class="reference internal" href="vignette.html#overview">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="vignette.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="vignette.html#running-the-ciss-vae-model">Running the CISS-VAE Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="vignette.html#hyperparameter-tuning-with-optuna">Hyperparameter Tuning with Optuna</a></li>
<li class="toctree-l1"><a class="reference internal" href="vignette.html#creating-a-clusterdataset-object">Creating a <code class="docutils literal notranslate"><span class="pre">ClusterDataset</span></code> object</a></li>
<li class="toctree-l1"><a class="reference internal" href="vignette.html#saving-and-loading-models">Saving and loading models</a></li>
<li class="toctree-l1"><a class="reference internal" href="missingness_prop_vignette.html">Using <code class="docutils literal notranslate"><span class="pre">create_missingness_prop_matrix</span></code>: A Complete Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="missingness_prop_vignette.html#integration-with-sample-clustering">Integration with sample clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="missingness_prop_vignette.html#integration-w-ciss-vae-pipeline">Integration w/ CISS-VAE pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="missingness_prop_vignette.html#full-workflow">Full workflow</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Avoiding imputation undesired data entries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#example-using-included-dataset">Example using included dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-run-cissvae-with-dni-matrix">Using <code class="docutils literal notranslate"><span class="pre">run_cissvae()</span></code> with DNI matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="#we-can-also-use-the-imputable-maatrix-with-the-autotune-function">We can also use the imputable maatrix with the autotune function.</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CISS-VAE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Avoiding imputation undesired data entries</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/dni_vignette.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="avoiding-imputation-undesired-data-entries">
<h1>Avoiding imputation undesired data entries<a class="headerlink" href="#avoiding-imputation-undesired-data-entries" title="Link to this heading"></a></h1>
<p>To avoid imputing certain missing datapoints, construct a <code class="docutils literal notranslate"><span class="pre">imputable_matrix</span></code>(DNI matrix) of the same size and shape as the original dataset. For this matrix, use 1 to represent values in the original dataset that are missing and viable for imputation or non-missing. Use 0 to represent values in the original dataset that are missing but not viable for imputation (for example, measurements at timepoints occuring after death). To use the <code class="docutils literal notranslate"><span class="pre">cols_ignore</span></code> argument in <code class="docutils literal notranslate"><span class="pre">run_cissvae</span></code> or <code class="docutils literal notranslate"><span class="pre">ClusterDataset()</span></code>, make sure that the <code class="docutils literal notranslate"><span class="pre">imputable_matrix</span></code> has the same column names/indices as the original dataset.</p>
<section id="example-using-included-dataset">
<h2>Example using included dataset<a class="headerlink" href="#example-using-included-dataset" title="Link to this heading"></a></h2>
<p>First load the dataset and load or create the DNI matrix. Here we can see that [1, Y12], [2, Y22], and [1, Y52] are marked as non-imputable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-plaintext notranslate"><div class="highlight"><pre><span></span>import pandas as pd
from ciss_vae.data import load_example_dataset, load_dni
import ciss_vae
print(ciss_vae.__file__)

df_missing, _, clusters = load_example_dataset()

dni = load_dni()

dni.columns = df_missing.columns

print(f&quot;Df missing:\n{df_missing.head(3).drop(df_missing.columns[:5].to_list(), axis=1)}, \n\nDo not impute:\n{dni.head(3).drop(df_missing.columns[:5].to_list(), axis=1)}&quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/nfs/vaithid1/CISS-VAE/CISS-VAE/src/ciss_vae/__init__.py
Df missing:
        Y11  Y12        Y13        Y14        Y15        Y21  Y22        Y23  \
0 -4.049537  NaN        NaN -14.369151 -17.564448        NaN  NaN -35.772630   
1  0.546168  NaN -12.189518  -7.722474        NaN  -7.470250  NaN -25.924360   
2       NaN  NaN -20.358905 -15.126494 -17.251376 -18.448422  NaN -34.400862   

         Y24        Y25  ...       Y41  Y42       Y43       Y44       Y45  \
0 -28.098906 -30.242588  ... -0.904960  NaN       NaN -3.694852 -5.680293   
1 -17.231424 -18.695290  ...  2.624586  NaN -5.776195 -1.379495 -2.329604   
2 -27.250598 -28.839809  ...       NaN  NaN -7.215718 -3.350797 -6.895340   

        Y51  Y52       Y53       Y54       Y55  
0  2.587588  NaN -4.681195 -2.248406 -2.679081  
1  6.080512  NaN -2.290062 -0.887398  0.562532  
2  2.531148  NaN -5.427430 -1.330163 -2.324382  

[3 rows x 25 columns], 

Do not impute:
   Y11  Y12  Y13  Y14  Y15  Y21  Y22  Y23  Y24  Y25  ...  Y41  Y42  Y43  Y44  \
0    1    1    1    1    1    1    1    1    1    1  ...    1    1    1    1   
1    1    0    1    1    1    1    1    1    1    1  ...    1    1    1    1   
2    1    1    1    1    1    1    0    1    1    1  ...    1    1    1    1   

   Y45  Y51  Y52  Y53  Y54  Y55  
0    1    1    1    1    1    1  
1    1    1    0    1    1    1  
2    1    1    1    1    1    1  

[3 rows x 25 columns]
</pre></div>
</div>
</div>
</div>
</section>
<section id="using-run-cissvae-with-dni-matrix">
<h2>Using <code class="docutils literal notranslate"><span class="pre">run_cissvae()</span></code> with DNI matrix<a class="headerlink" href="#using-run-cissvae-with-dni-matrix" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">run_cissvae()</span></code> function can accept the DNI matrix as an input. Make sure that the column names of the DNI matrix match those of the original dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-plaintext notranslate"><div class="highlight"><pre><span></span>from ciss_vae.training.run_cissvae import run_cissvae
from ciss_vae.utils.helpers import plot_vae_architecture

imputed_data, vae, ds, history = run_cissvae(data = df_missing,
## Dataset params
    columns_ignore = df_missing.columns[:5], ## columns to ignore when selecting validation dataset (and clustering if you do not provide clusters). For example, demographic columns with no missingness.
    imputable_matrix=dni,
    clusters = clusters,
    print_dataset = False,
    
## VAE model params
    hidden_dims = [150, 120, 60], ## Dimensions of hidden layers, in order. One number per layer. 
    latent_dim = 15, ## Dimensions of latent embedding
    layer_order_enc = [&quot;unshared&quot;, &quot;unshared&quot;, &quot;unshared&quot;], ## order of shared vs unshared layers for encode (can use u or s instead of unshared, shared)
    layer_order_dec=[&quot;shared&quot;, &quot;shared&quot;,  &quot;shared&quot;],  ## order of shared vs unshared layers for decode
    latent_shared=False, 
    output_shared=False, 
    batch_size = 4000, ## batch size for data loader
    return_model = True, ## if true, outputs imputed dataset and model, otherwise just outputs imputed dataset. Set to true to return model for `plot_vae_architecture`

## Initial Training params
    epochs = 5, ## default 

## Other params
    return_history = True, ## if true, will return training MSE history as pandas dataframe
    return_dataset=True
)

print(f&quot;The successfully imputed dataset:\n{imputed_data.head}\n\n&quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The successfully imputed dataset:
&lt;bound method NDFrame.head of             Age    Salary  ZipCode10001  ZipCode20002  ZipCode30003  \
0     11.044449  6.366204           0.0           1.0           0.0   
1      9.727260  5.912558           1.0           0.0           0.0   
2     11.383020  6.636472           0.0           1.0           0.0   
3     13.560905  5.896255           0.0           0.0           1.0   
4      9.542490  6.128326           1.0           0.0           0.0   
...         ...       ...           ...           ...           ...   
7995  15.557709  6.202669           1.0           0.0           0.0   
7996  10.675848  6.294101           1.0           0.0           0.0   
7997   8.461785  5.317789           0.0           0.0           1.0   
7998  13.917788  5.052571           0.0           0.0           1.0   
7999  15.152122  5.258686           1.0           0.0           0.0   

            Y11        Y12         Y13         Y14         Y15  ...       Y41  \
0     -4.049537 -25.333433  -18.179119  -14.369148  -17.564449  ... -0.904960   
1      0.546168        NaN  -12.189518   -7.722473   -8.393543  ...  2.624586   
2     -6.705932 -25.998434  -20.358906  -15.126495  -17.251377  ... -0.955551   
3    -10.608213 -21.735437  -13.312706  -14.207619  -21.339748  ... -2.825192   
4      0.357588 -16.487692  -11.312771   -5.675655         NaN  ...  3.617390   
...         ...        ...         ...         ...         ...  ...       ...   
7995   0.004673  68.338669  127.004562  166.543167  189.465057  ...  4.190835   
7996   9.732808  58.953075  102.710716  135.753891  152.616577  ...  5.976947   
7997  13.310965  52.694130   84.626495  107.389328  124.735504  ...  6.921663   
7998   0.670269  57.290031  109.489731  143.899231  164.870361  ...  3.977530   
7999  -5.307739  58.862980  117.229599  152.684494  178.404663  ...  4.620643   

            Y42        Y43        Y44        Y45       Y51        Y52  \
0     -9.854912  -7.413225  -3.694853  -5.680294  2.587588  -6.005280   
1     -6.270187  -5.776196  -1.379498  -2.329605  6.080512        NaN   
2    -10.401142  -7.215719  -3.350798  -6.895340  2.531148  -6.401376   
3           NaN  -8.293898  -2.398298  -2.642437  0.138556  -5.609408   
4     -4.619453  -3.856876  -0.338383  -1.495659  3.421927  -3.341182   
...         ...        ...        ...        ...       ...        ...   
7995  37.229931  66.995651  84.691528  96.805740  6.542590  34.403015   
7996  28.959558  53.110542  67.145432  75.380974  6.311522  26.652737   
7997  25.361666  42.306374  53.189552  59.775707  6.992176  23.954103   
7998  30.719467  57.480675  72.764549  82.690750  5.347935  27.920717   
7999  32.284439  60.907463  79.353737  89.973381  2.795478  30.544744   

            Y53        Y54        Y55  
0     -4.681194  -2.248405  -2.679079  
1     -2.290061  -0.887398   0.562531  
2     -5.427431  -1.330164  -2.324381  
3     -5.729858  -1.639587  -4.445707  
4     -1.915190   1.323397   0.103451  
...         ...        ...        ...  
7995  57.426338  74.096107  83.017654  
7996  47.063118  58.854687  65.740067  
7997  37.583347  48.980991  52.618183  
7998  49.049713  63.465157  73.865051  
7999  51.202316  67.612328  76.804909  

[8000 rows x 30 columns]&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-plaintext notranslate"><div class="highlight"><pre><span></span>ds
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ClusterDataset(n_samples=8000, n_features=30, n_clusters=4)
  • Original missing: 61800 / 200000 (30.90%)
  • Validation held-out: 13854 (10.02% of non-missing)
  • .data shape:     (8000, 30)
  • .masks shape:    (8000, 30)
  • .val_data shape: (8000, 30)
</pre></div>
</div>
</div>
</div>
<p>Below, we can see that [1, Y12], [2, Y22], and [1, Y52] are still NaN, even though other missing entries have been imputed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-plaintext notranslate"><div class="highlight"><pre><span></span>print(f&quot;Imputed dataset:\n{imputed_data.drop(df_missing.columns[:5].to_list(), axis=1).head(3)}&quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Imputed dataset:
        Y11        Y12        Y13        Y14        Y15        Y21        Y22  \
0 -4.049537 -25.333433 -18.179119 -14.369148 -17.564449 -17.193937 -38.320435   
1  0.546168        NaN -12.189518  -7.722473  -8.393543  -7.470250 -27.492477   
2 -6.705932 -25.998434 -20.358906 -15.126495 -17.251377 -18.448421        NaN   

         Y23        Y24        Y25  ...       Y41        Y42       Y43  \
0 -35.772636 -28.098907 -30.242596  ... -0.904960  -9.854912 -7.413225   
1 -25.924362 -17.231424 -18.695286  ...  2.624586  -6.270187 -5.776196   
2 -34.400864 -27.250603 -28.839809  ... -0.955551 -10.401142 -7.215719   

        Y44       Y45       Y51       Y52       Y53       Y54       Y55  
0 -3.694853 -5.680294  2.587588 -6.005280 -4.681194 -2.248405 -2.679079  
1 -1.379498 -2.329605  6.080512       NaN -2.290061 -0.887398  0.562531  
2 -3.350798 -6.895340  2.531148 -6.401376 -5.427431 -1.330164 -2.324381  

[3 rows x 25 columns]
</pre></div>
</div>
</div>
</div>
<p>As always, the vae architecture can be printed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-plaintext notranslate"><div class="highlight"><pre><span></span>plot_vae_architecture(model = vae,
                        title = None, ## Set title of plot
                        ## Colors below are default
                        color_shared = &quot;skyblue&quot;, 
                        color_unshared =&quot;lightcoral&quot;,
                        color_latent = &quot;gold&quot;, # xx fix
                        color_input = &quot;lightgreen&quot;,
                        color_output = &quot;lightgreen&quot;,
                        figsize=(16, 8),
                        return_fig = False)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6a2ee139389a7895bdaa37b24579ae01db6b630648e491a486cbe5f54181ffd8.png" src="_images/6a2ee139389a7895bdaa37b24579ae01db6b630648e491a486cbe5f54181ffd8.png" />
</div>
</div>
</section>
<section id="we-can-also-use-the-imputable-maatrix-with-the-autotune-function">
<h2>We can also use the imputable maatrix with the autotune function.<a class="headerlink" href="#we-can-also-use-the-imputable-maatrix-with-the-autotune-function" title="Link to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-plaintext notranslate"><div class="highlight"><pre><span></span>import pandas as pd
from ciss_vae.data import load_example_dataset, load_dni
import ciss_vae
from ciss_vae.classes.cluster_dataset import ClusterDataset
from ciss_vae.training.autotune import SearchSpace, autotune

print(ciss_vae.__file__)

df_missing, _, clusters = load_example_dataset()

dni = load_dni()

dataset = ClusterDataset(
    data = df_missing,
    cluster_labels = clusters,
    imputable = dni,

)

dataset
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/nfs/vaithid1/CISS-VAE/CISS-VAE/src/ciss_vae/__init__.py
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ClusterDataset(n_samples=8000, n_features=30, n_clusters=4)
  • Original missing: 61800 / 240000 (25.75%)
  • Validation held-out: 17854 (10.02% of non-missing)
  • .data shape:     (8000, 30)
  • .masks shape:    (8000, 30)
  • .val_data shape: (8000, 30)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-plaintext notranslate"><div class="highlight"><pre><span></span>searchspace = SearchSpace(
                 num_hidden_layers=(1, 4), ## Set number of hidden layers
                 hidden_dims=[64, 512], ## Allowable dimensions of hidden layers
                 latent_dim=[10, 100],
                 latent_shared=[True, False],
                 output_shared=[True,False],
                 lr=(1e-4, 1e-3),
                 decay_factor=(0.9, 0.999),
                 beta=0.01,
                 num_epochs=100,
                 batch_size=64,
                 num_shared_encode=[0, 1, 3],
                 num_shared_decode=[0, 1, 3],
                 encoder_shared_placement = [&quot;at_end&quot;, &quot;at_start&quot;, &quot;alternating&quot;, &quot;random&quot;], ## where should the shared layers be placed in the encoder
                 decoder_shared_placement = [&quot;at_end&quot;, &quot;at_start&quot;, &quot;alternating&quot;, &quot;random&quot;], ## where should the shared layers be placed in the decoder
                 refit_patience=2,
                 refit_loops=10,
                 epochs_per_loop = 100,
                 reset_lr_refit = [True, False])

results = autotune(
    search_space = searchspace,
    train_dataset = dataset,                   # ClusterDataset object
    save_model_path=None,
    save_search_space_path=None,
    n_trials=20,
    study_name=&quot;vae_autotune_v3&quot;,                 # Default study name
    device_preference=&quot;cuda&quot;,
    show_progress=True,                       # Show progress bar for training
    optuna_dashboard_db=&quot;sqlite:///test_dni_python.sqlite3&quot;,                  # If using optuna dashboard set db location here
    load_if_exists=True,                       # If using optuna dashboard, if study by &#39;study_name&#39; already exists, will load that study
    seed = 42,     
)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-09-25 14:57:40,660] A new study created in RDB with name: vae_autotune_v3
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Warning] CUDA requested but not available. Falling back to CPU.
<span class=" -Color -Color-Bold -Color-Bold-Blue">Starting Optuna optimization with 20 trials...</span>

<span class=" -Color -Color-Green">Trial </span><span class=" -Color -Color-Bold -Color-Bold-Green">1</span><span class=" -Color -Color-Green">/</span><span class=" -Color -Color-Bold -Color-Bold-Green">20</span>
Parameters: <span class=" -Color -Color-Yellow">layers</span>=<span class=" -Color -Color-Bold -Color-Bold-Cyan">2</span>, <span class=" -Color -Color-Yellow">latent_dim</span>=<span class=" -Color -Color-Bold -Color-Bold-Cyan">100</span>, <span class=" -Color -Color-Yellow">lr</span>=<span class=" -Color -Color-Bold -Color-Bold-Cyan">1.21e-04</span>, <span class=" -Color -Color-Yellow">batch_size</span>=<span class=" -Color -Color-Bold -Color-Bold-Cyan">64</span>
Initial training <span class=" -Color -Color-C237">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Magenta">  0%</span> <span class=" -Color -Color-Cyan">-:--:--</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/nfs/vaithid1/CISS-VAE/CISS-VAE/src/ciss_vae/training/autotune.py:518: ExperimentalWarning: set_metric_names is experimental (supported from v3.2.0). The interface can change in the future.
  study.set_metric_names([&quot;Validation MSE&quot;])
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initial training <span class=" -Color -Color-Red">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Magenta">100%</span> <span class=" -Color -Color-Yellow">0:00:48</span>% <span class=" -Color -Color-Cyan">0:00:01</span>[36m0:00:02
Refit loops ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸ <span class=" -Color -Color-Magenta">100%</span> <span class=" -Color -Color-Cyan">0:00:01</span>[36m0:00:12
?25h✓ Trial <span class=" -Color -Color-Bold -Color-Bold-Cyan">1</span> complete - MSE: <span class=" -Color -Color-Bold -Color-Bold-Cyan">6.6975</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-09-25 15:05:52,038] Trial 0 finished with value: {&#39;Validation MSE&#39;: 6.697518825531006} and parameters: {&#39;num_hidden_layers&#39;: 2, &#39;hidden_dim_0&#39;: 512, &#39;hidden_dim_1&#39;: 64, &#39;latent_dim&#39;: 100, &#39;latent_shared&#39;: False, &#39;output_shared&#39;: False, &#39;lr&#39;: 0.00012101656685485331, &#39;decay_factor&#39;: 0.9094310949685148, &#39;num_shared_encode&#39;: 3, &#39;num_shared_decode&#39;: 3, &#39;encoder_shared_placement&#39;: &#39;at_end&#39;, &#39;decoder_shared_placement&#39;: &#39;at_end&#39;, &#39;reset_lr_refit&#39;: False}. Best is trial 0 with value: 6.697518825531006.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Trial </span><span class=" -Color -Color-Bold -Color-Bold-Green">2</span><span class=" -Color -Color-Green">/</span><span class=" -Color -Color-Bold -Color-Bold-Green">20</span>
Parameters: <span class=" -Color -Color-Yellow">layers</span>=<span class=" -Color -Color-Bold -Color-Bold-Cyan">4</span>, <span class=" -Color -Color-Yellow">latent_dim</span>=<span class=" -Color -Color-Bold -Color-Bold-Cyan">10</span>, <span class=" -Color -Color-Yellow">lr</span>=<span class=" -Color -Color-Bold -Color-Bold-Cyan">5.31e-04</span>, <span class=" -Color -Color-Yellow">batch_size</span>=<span class=" -Color -Color-Bold -Color-Bold-Cyan">64</span>
Initial training <span class=" -Color -Color-Red">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Magenta">100%</span> <span class=" -Color -Color-Yellow">0:01:07</span>% <span class=" -Color -Color-Cyan">0:00:01</span>[36m0:00:03
Refit loops ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸ <span class=" -Color -Color-Magenta">100%</span> <span class=" -Color -Color-Cyan">0:00:01</span>[36m0:00:18
?25h✓ Trial <span class=" -Color -Color-Bold -Color-Bold-Cyan">2</span> complete - MSE: <span class=" -Color -Color-Bold -Color-Bold-Cyan">6.6964</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-09-25 15:17:54,468] Trial 1 finished with value: {&#39;Validation MSE&#39;: 6.696430683135986} and parameters: {&#39;num_hidden_layers&#39;: 4, &#39;hidden_dim_0&#39;: 64, &#39;hidden_dim_1&#39;: 64, &#39;hidden_dim_2&#39;: 64, &#39;hidden_dim_3&#39;: 64, &#39;latent_dim&#39;: 10, &#39;latent_shared&#39;: False, &#39;output_shared&#39;: False, &#39;lr&#39;: 0.0005309640362314614, &#39;decay_factor&#39;: 0.9386587580379689, &#39;num_shared_encode&#39;: 3, &#39;num_shared_decode&#39;: 0, &#39;encoder_shared_placement&#39;: &#39;at_start&#39;, &#39;decoder_shared_placement&#39;: &#39;alternating&#39;, &#39;reset_lr_refit&#39;: False}. Best is trial 1 with value: 6.696430683135986.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Trial </span><span class=" -Color -Color-Bold -Color-Bold-Green">3</span><span class=" -Color -Color-Green">/</span><span class=" -Color -Color-Bold -Color-Bold-Green">20</span>
Parameters: <span class=" -Color -Color-Yellow">layers</span>=<span class=" -Color -Color-Bold -Color-Bold-Cyan">4</span>, <span class=" -Color -Color-Yellow">latent_dim</span>=<span class=" -Color -Color-Bold -Color-Bold-Cyan">10</span>, <span class=" -Color -Color-Yellow">lr</span>=<span class=" -Color -Color-Bold -Color-Bold-Cyan">1.20e-04</span>, <span class=" -Color -Color-Yellow">batch_size</span>=<span class=" -Color -Color-Bold -Color-Bold-Cyan">64</span>
Initial training <span class=" -Color -Color-Red">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Magenta">100%</span> <span class=" -Color -Color-Yellow">0:02:13</span>% <span class=" -Color -Color-Cyan">0:00:02</span>[36m0:00:04
Refit loops ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╸ <span class=" -Color -Color-Magenta">100%</span> <span class=" -Color -Color-Cyan">0:00:02</span>[36m0:00:32
?25h✓ Trial <span class=" -Color -Color-Bold -Color-Bold-Cyan">3</span> complete - MSE: <span class=" -Color -Color-Bold -Color-Bold-Cyan">6.0030</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[I 2025-09-25 15:40:31,460] Trial 2 finished with value: {&#39;Validation MSE&#39;: 6.003026485443115} and parameters: {&#39;num_hidden_layers&#39;: 4, &#39;hidden_dim_0&#39;: 64, &#39;hidden_dim_1&#39;: 512, &#39;hidden_dim_2&#39;: 512, &#39;hidden_dim_3&#39;: 64, &#39;latent_dim&#39;: 10, &#39;latent_shared&#39;: True, &#39;output_shared&#39;: False, &#39;lr&#39;: 0.0001199515274663907, &#39;decay_factor&#39;: 0.9695420241217254, &#39;num_shared_encode&#39;: 3, &#39;num_shared_decode&#39;: 3, &#39;encoder_shared_placement&#39;: &#39;random&#39;, &#39;decoder_shared_placement&#39;: &#39;at_start&#39;, &#39;reset_lr_refit&#39;: True}. Best is trial 2 with value: 6.003026485443115.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">Trial </span><span class=" -Color -Color-Bold -Color-Bold-Green">4</span><span class=" -Color -Color-Green">/</span><span class=" -Color -Color-Bold -Color-Bold-Green">20</span>
Parameters: <span class=" -Color -Color-Yellow">layers</span>=<span class=" -Color -Color-Bold -Color-Bold-Cyan">4</span>, <span class=" -Color -Color-Yellow">latent_dim</span>=<span class=" -Color -Color-Bold -Color-Bold-Cyan">100</span>, <span class=" -Color -Color-Yellow">lr</span>=<span class=" -Color -Color-Bold -Color-Bold-Cyan">6.34e-04</span>, <span class=" -Color -Color-Yellow">batch_size</span>=<span class=" -Color -Color-Bold -Color-Bold-Cyan">64</span>
Initial training <span class=" -Color -Color-Red">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Magenta">100%</span> <span class=" -Color -Color-Yellow">0:01:39</span>% <span class=" -Color -Color-Cyan">0:00:02</span>[36m0:00:04
Refit loops ━━━━━━━━━━━━━━━━━━━━━━╸<span class=" -Color -Color-C237">━━━━━━━━━━━━━━━━━</span> <span class=" -Color -Color-Magenta"> 56%</span> <span class=" -Color -Color-Cyan">0:07:04</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="missingness_prop_vignette.html" class="btn btn-neutral float-left" title="Using create_missingness_prop_matrix: A Complete Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="api.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Yasin Khadem Charvadeh, Danielle Vaithilingam, Kenneth Seier, Katherine S. Panageas, Mithat Gönen, Yuan Chen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>